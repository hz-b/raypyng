%% Generated by Sphinx.
\def\sphinxdocclass{report}
\documentclass[letterpaper,10pt,english]{sphinxmanual}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}

\PassOptionsToPackage{warn}{textcomp}
\usepackage[utf8]{inputenc}
\ifdefined\DeclareUnicodeCharacter
% support both utf8 and utf8x syntaxes
  \ifdefined\DeclareUnicodeCharacterAsOptional
    \def\sphinxDUC#1{\DeclareUnicodeCharacter{"#1}}
  \else
    \let\sphinxDUC\DeclareUnicodeCharacter
  \fi
  \sphinxDUC{00A0}{\nobreakspace}
  \sphinxDUC{2500}{\sphinxunichar{2500}}
  \sphinxDUC{2502}{\sphinxunichar{2502}}
  \sphinxDUC{2514}{\sphinxunichar{2514}}
  \sphinxDUC{251C}{\sphinxunichar{251C}}
  \sphinxDUC{2572}{\textbackslash}
\fi
\usepackage{cmap}
\usepackage[T1]{fontenc}
\usepackage{amsmath,amssymb,amstext}
\usepackage{babel}



\usepackage{tgtermes}
\usepackage{tgheros}
\renewcommand{\ttdefault}{txtt}



\usepackage[Bjarne]{fncychap}
\usepackage{sphinx}

\fvset{fontsize=auto}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Contents:}}

\usepackage{sphinxmessages}
\setcounter{tocdepth}{2}



\title{RayPyNG}
\date{Dec 05, 2022}
\release{}
\author{Simone Vadilonga, Ruslan Ovsyannikov}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\ifdefined\shorthandoff
  \ifnum\catcode`\=\string=\active\shorthandoff{=}\fi
  \ifnum\catcode`\"=\active\shorthandoff{"}\fi
\fi

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{index::doc}}


\sphinxAtStartPar
raypyng provides a simple python API to work with
\sphinxhref{https://www.helmholtz-berlin.de/forschung/oe/wi/optik-strahlrohre/arbeitsgebiete/ray\_en.html}{RAY\sphinxhyphen{}UI},
a software for optical simulation of synchrotron
beamlines and x\sphinxhyphen{}ray systems developed by
Helmholtz\sphinxhyphen{}Zentrum Berlin.

\sphinxstepscope


\chapter{Installation}
\label{\detokenize{installation:installation}}\label{\detokenize{installation::doc}}
\sphinxAtStartPar
raypyng will work only if using a Linux or a macOS distribution.


\section{Install RAY\sphinxhyphen{}UI}
\label{\detokenize{installation:install-ray-ui}}
\sphinxAtStartPar
Download the RAY\sphinxhyphen{}UI installer from  \sphinxhref{https://www.helmholtz-berlin.de/forschung/oe/wi/optik-strahlrohre/arbeitsgebiete/ray\_en.html}{this link},
and run the installer.


\section{Install xvfb}
\label{\detokenize{installation:install-xvfb}}
\sphinxAtStartPar
xvfb is a virtual X11 framebuffer server that let you run RAY\sphinxhyphen{}UI headless

\sphinxAtStartPar
Install xvfb:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
sudo apt install xvfb
\end{sphinxVerbatim}

\begin{sphinxadmonition}{note}{Note:}
\sphinxAtStartPar
xvfb\sphinxhyphen{}run script is a part of the xvfb distribution and
runs an app on a new virtual X11 server.
\end{sphinxadmonition}


\section{Install raypyng}
\label{\detokenize{installation:install-raypyng}}\begin{itemize}
\item {} 
\sphinxAtStartPar
You will need Python 3.8 or newer. From a shell (“Terminal” on OSX),
check your current Python version.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python3 \PYGZhy{}\PYGZhy{}version
\end{sphinxVerbatim}

\sphinxAtStartPar
If that version is less than 3.8, you must update it.

\sphinxAtStartPar
We recommend installing raypyng into a “virtual environment” so that this
installation will not interfere with any existing Python software:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python3 \PYGZhy{}m venv \PYGZti{}/raypyng\PYGZhy{}tutorial
\PYG{n+nb}{source} \PYGZti{}/raypyng\PYGZhy{}tutorial/bin/activate
\end{sphinxVerbatim}

\sphinxAtStartPar
Alternatively, if you are a
\sphinxhref{https://conda.io/docs/user-guide/install/download.html}{conda} user,
you can create a conda environment:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
conda create \PYGZhy{}n raypyng\PYGZhy{}tutorial \PYG{l+s+s2}{\PYGZdq{}python\PYGZgt{}=3.8\PYGZdq{}}
conda activate raypyng\PYGZhy{}tutorial
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Install the latest versions of raypyng and ophyd. Also, install IPython
(a Python interpreter designed by scientists for scientists).

\begin{sphinxVerbatim}[commandchars=\\\{\}]
python3 \PYGZhy{}m pip install \PYGZhy{}\PYGZhy{}upgrade raypyng ipython
\end{sphinxVerbatim}

\item {} 
\sphinxAtStartPar
Start IPython:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ipython} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{matplotlib}\PYG{o}{=}\PYG{n}{qt5}
\end{sphinxVerbatim}

\sphinxAtStartPar
The flag \sphinxcode{\sphinxupquote{\sphinxhyphen{}\sphinxhyphen{}matplotlib=qt5}} is necessary for live\sphinxhyphen{}updating plots to work.

\sphinxAtStartPar
Or, if you wish you use raypyng from a Jupyter notebook, install a kernel like
so:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{ipython} \PYG{n}{kernel} \PYG{n}{install} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{user} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{name}\PYG{o}{=}\PYG{n}{raypyng}\PYG{o}{\PYGZhy{}}\PYG{n}{tutorial} \PYG{o}{\PYGZhy{}}\PYG{o}{\PYGZhy{}}\PYG{n}{display}\PYG{o}{\PYGZhy{}}\PYG{n}{name} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Python (raypyng)}\PYG{l+s+s2}{\PYGZdq{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
You may start Jupyter from any environment where it is already installed, or
install it in this environment alongside raypyng and run it from there:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{pip} \PYG{n}{install} \PYG{n}{notebook}
\PYG{n}{jupyter} \PYG{n}{notebook}
\end{sphinxVerbatim}

\end{itemize}

\sphinxstepscope


\chapter{Tutorial}
\label{\detokenize{tutorial:tutorial}}\label{\detokenize{tutorial::doc}}

\section{Manipulate an RML file}
\label{\detokenize{tutorial:manipulate-an-rml-file}}
\sphinxAtStartPar
Using the \sphinxcode{\sphinxupquote{RMLFile}} class it is possible to manupulate an beamline file produced by RAY\sphinxhyphen{}UI.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{:} \PYG{k+kn}{from} \PYG{n+nn}{raypyng}\PYG{n+nn}{.}\PYG{n+nn}{rml} \PYG{k+kn}{import} \PYG{n}{RMLFile}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:} \PYG{n}{rml} \PYG{o}{=} \PYG{n}{RMLFile}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/elisa.rml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:} \PYG{n}{rml}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{:} \PYG{n}{RMLFile}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/elisa.rml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{template}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/elisa.rml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
The filename can be accesed with the filename \sphinxcode{\sphinxupquote{attribute}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{9}\PYG{p}{]}\PYG{p}{:} \PYG{n}{rml}\PYG{o}{.}\PYG{n}{filename}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{9}\PYG{p}{]}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/elisa.rml}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
and the beamline is available under:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{10}\PYG{p}{]}\PYG{p}{:} \PYG{n}{elisa} \PYG{o}{=} \PYG{n}{rml}\PYG{o}{.}\PYG{n}{beamline}
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{11}\PYG{p}{]}\PYG{p}{:} \PYG{n}{elisa}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{11}\PYG{p}{]}\PYG{p}{:} \PYG{n}{XmlElement}\PYG{p}{(}\PYG{n}{name} \PYG{o}{=} \PYG{n}{beamline}\PYG{p}{,} \PYG{n}{attributes} \PYG{o}{=} \PYG{p}{\PYGZob{}}\PYG{p}{\PYGZcb{}}\PYG{p}{,} \PYG{n}{cdata} \PYG{o}{=} \PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
It is possible to list all the element present in the beamlne using
the \sphinxcode{\sphinxupquote{children()}} method

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{14}\PYG{p}{]}\PYG{p}{:} \PYG{k}{for} \PYG{n}{i}\PYG{p}{,} \PYG{n}{oe} \PYG{o+ow}{in} \PYG{n+nb}{enumerate}\PYG{p}{(}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{children}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
  \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:}     \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{OE }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}\PYG{n}{i}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{oe}\PYG{o}{.}\PYG{n}{resolvable\PYGZus{}name}\PYG{p}{(}\PYG{p}{)}\PYG{p}{)}
  \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:}
\PYG{n}{OE}  \PYG{l+m+mi}{0} \PYG{p}{:} \PYG{n}{Dipole}
\PYG{n}{OE}  \PYG{l+m+mi}{1} \PYG{p}{:} \PYG{n}{M1}
\PYG{n}{OE}  \PYG{l+m+mi}{2} \PYG{p}{:} \PYG{n}{PremirrorM2}
\PYG{n}{OE}  \PYG{l+m+mi}{3} \PYG{p}{:} \PYG{n}{PG}
\PYG{n}{OE}  \PYG{l+m+mi}{4} \PYG{p}{:} \PYG{n}{M3}
\PYG{n}{OE}  \PYG{l+m+mi}{5} \PYG{p}{:} \PYG{n}{ExitSlit}
\PYG{n}{OE}  \PYG{l+m+mi}{6} \PYG{p}{:} \PYG{n}{KB1}
\PYG{n}{OE}  \PYG{l+m+mi}{7} \PYG{p}{:} \PYG{n}{KB2}
\PYG{n}{OE}  \PYG{l+m+mi}{8} \PYG{p}{:} \PYG{n}{DetectorAtFocus}
\end{sphinxVerbatim}

\sphinxAtStartPar
In a similar way one can print all the available paramters of a certain element.
For instance, to print all the parameters of the Dipole:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{15}\PYG{p}{]}\PYG{p}{:} \PYG{c+c1}{\PYGZsh{} print all the parameters of the Dipole}
  \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:} \PYG{k}{for} \PYG{n}{param} \PYG{o+ow}{in} \PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{children}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
  \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:}     \PYG{n+nb}{print}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{Dipole param: }\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{param}\PYG{o}{.}\PYG{n}{id}\PYG{p}{)}
  \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{numberRays}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{sourceWidth}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{sourceHeight}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{verEbeamDiv}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{horDiv}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{electronEnergy}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{electronEnergyOrientation}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{bendingRadius}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{alignmentError}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{translationXerror}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{translationYerror}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{rotationXerror}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{rotationYerror}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{energyDistributionType}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{photonEnergyDistributionFile}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{photonEnergy}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{energySpreadType}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{energySpreadUnit}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{energySpread}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{sourcePulseType}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{sourcePulseLength}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{photonFlux}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{worldPosition}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{worldXdirection}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{worldYdirection}
\PYG{n}{Dipole} \PYG{n}{param}\PYG{p}{:}  \PYG{n}{worldZdirection}
\end{sphinxVerbatim}

\sphinxAtStartPar
Any parameter can be modified in this way:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{17}\PYG{p}{]}\PYG{p}{:} \PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonEnergy}\PYG{o}{.}\PYG{n}{cdata}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{17}\PYG{p}{]}\PYG{p}{:} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{1000}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{18}\PYG{p}{]}\PYG{p}{:} \PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonEnergy}\PYG{o}{.}\PYG{n}{cdata} \PYG{o}{=} \PYG{n+nb}{str}\PYG{p}{(}\PYG{l+m+mi}{2000}\PYG{p}{)}

\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{19}\PYG{p}{]}\PYG{p}{:} \PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonEnergy}\PYG{o}{.}\PYG{n}{cdata}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{19}\PYG{p}{]}\PYG{p}{:} \PYG{l+m+mi}{2000}
\end{sphinxVerbatim}

\sphinxAtStartPar
Once you are done with the modifications, you can save the rml file using the \sphinxcode{\sphinxupquote{write()}} method

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{rml}\PYG{o}{.}\PYG{n}{write}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/new\PYGZus{}elisa.rml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\end{sphinxVerbatim}


\section{RAY\sphinxhyphen{}UI API}
\label{\detokenize{tutorial:ray-ui-api}}
\sphinxAtStartPar
Using the \sphinxcode{\sphinxupquote{RayUIRunner}} and the \sphinxcode{\sphinxupquote{RayUIAPI}} classes it is possible
to interact with RAY\sphinxhyphen{}UI directly from python.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{]}\PYG{p}{:} \PYG{k+kn}{import} \PYG{n+nn}{os}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:} \PYG{k+kn}{import} \PYG{n+nn}{time}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:} \PYG{k+kn}{from} \PYG{n+nn}{raypyng}\PYG{n+nn}{.}\PYG{n+nn}{runner} \PYG{k+kn}{import} \PYG{n}{RayUIRunner}\PYG{p}{,} \PYG{n}{RayUIAPI}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:} \PYG{n}{r} \PYG{o}{=} \PYG{n}{RayUIRunner}\PYG{p}{(}\PYG{n}{ray\PYGZus{}path}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,} \PYG{n}{hide}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:} \PYG{n}{a} \PYG{o}{=} \PYG{n}{RayUIAPI}\PYG{p}{(}\PYG{n}{r}\PYG{p}{)}

\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{:} \PYG{n}{r}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{p}{)}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{2}\PYG{p}{]}\PYG{p}{:} \PYG{o}{\PYGZlt{}}\PYG{n}{raypyng}\PYG{o}{.}\PYG{n}{runner}\PYG{o}{.}\PYG{n}{RayUIRunner} \PYG{n}{at} \PYG{l+m+mh}{0x7effd8f53b50}\PYG{o}{\PYGZgt{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
Once an instance of RAY\sphinxhyphen{}UI is running, we can confirm that it is running
and we can ask the \sphinxcode{\sphinxupquote{pid}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{:} \PYG{n}{r}\PYG{o}{.}\PYG{n}{isrunning}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{3}\PYG{p}{]}\PYG{p}{:} \PYG{k+kc}{True}

\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{:} \PYG{n}{r}\PYG{o}{.}\PYG{n}{pid}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{4}\PYG{p}{]}\PYG{p}{:} \PYG{l+m+mi}{20742}
\end{sphinxVerbatim}

\sphinxAtStartPar
It is possible to load an rml file and trace it

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{:} \PYG{n}{a}\PYG{o}{.}\PYG{n}{load}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/elisa.rml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{:} \PYG{k+kc}{True}

\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{:} \PYG{n}{a}\PYG{o}{.}\PYG{n}{trace}\PYG{p}{(}\PYG{n}{analyze}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
  \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{6}\PYG{p}{]}\PYG{p}{:} \PYG{k+kc}{True}
\end{sphinxVerbatim}

\sphinxAtStartPar
Export the files for the elements of interest:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{7}\PYG{p}{]}\PYG{p}{:} \PYG{n}{a}\PYG{o}{.}\PYG{n}{export}\PYG{p}{(}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{Dipole,DetectorAtFocus}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{RawRaysOutgoing}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/home/simone/Documents/RAYPYNG/raypyng/examples}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{test\PYGZus{}export}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
 \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}\PYG{p}{:}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{7}\PYG{p}{]}\PYG{p}{:} \PYG{k+kc}{True}
\end{sphinxVerbatim}

\sphinxAtStartPar
Save the rml file used for the simulation (this is useful because RAY\sphinxhyphen{}UI
when it traces the beamline it updates the RML files with the latest parameters: for
instance if you change the photon energy, it will update the source flux)

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{:} \PYG{n}{a}\PYG{o}{.}\PYG{n}{save}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/new\PYGZus{}elisa}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
\PYG{n}{Out}\PYG{p}{[}\PYG{l+m+mi}{8}\PYG{p}{]}\PYG{p}{:} \PYG{k+kc}{True}
\end{sphinxVerbatim}

\sphinxAtStartPar
And finally we can quit the RAY\sphinxhyphen{}UI instance that we opened:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{In} \PYG{p}{[}\PYG{l+m+mi}{9}\PYG{p}{]}\PYG{p}{:} \PYG{n}{a}\PYG{o}{.}\PYG{n}{quit}\PYG{p}{(}\PYG{p}{)}
\end{sphinxVerbatim}


\section{Simulations}
\label{\detokenize{tutorial:simulations}}

\subsection{Perform Simulations}
\label{\detokenize{tutorial:perform-simulations}}
\sphinxAtStartPar
raypyng is not able to create a beamline from scratch. To do so, use RAY\sphinxhyphen{}UI,
create a beamline, and save it. What you save is \sphinxcode{\sphinxupquote{.rml}} file, which you have to
pass as an argument to the \sphinxcode{\sphinxupquote{Simulate}} class. In the following example, we
use the file for a beamline called \sphinxtitleref{elisa}, and the file is saved in \sphinxcode{\sphinxupquote{rml/elisa.rml}}.
The \sphinxcode{\sphinxupquote{hide}} parameter can be set to true only if \sphinxtitleref{xvfb} is installed.

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{raypyng} \PYG{k+kn}{import} \PYG{n}{Simulate}
\PYG{n}{rml\PYGZus{}file} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml/elisa.rml}\PYG{l+s+s1}{\PYGZsq{}}

\PYG{n}{sim} \PYG{o}{=} \PYG{n}{Simulate}\PYG{p}{(}\PYG{n}{rml\PYGZus{}file}\PYG{p}{,} \PYG{n}{hide}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\PYG{n}{elisa} \PYG{o}{=} \PYG{n}{sim}\PYG{o}{.}\PYG{n}{rml}\PYG{o}{.}\PYG{n}{beamline}
\end{sphinxVerbatim}

\sphinxAtStartPar
The elements of the beamline are now available as python objects, as well as
their properties. If working in ipython, tab autocompletion is available.
For instance to access the source, a dipole in this case:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} this is the dipole object}
\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}
\PYG{c+c1}{\PYGZsh{} to acess its parameter, for instance, the photonFlux}
\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonFlux}
\PYG{c+c1}{\PYGZsh{} to access the value}
\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonFlux}\PYG{o}{.}\PYG{n}{cdata}
\PYG{c+c1}{\PYGZsh{} to modify the value}
\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonFlux}\PYG{o}{.}\PYG{n}{cdata} \PYG{o}{=} \PYG{l+m+mi}{10}
\end{sphinxVerbatim}

\sphinxAtStartPar
To perform a simulation, any number of parameters can be varied.
For instance, one can vary the photon energy of the source, and set a
a certain aperture of the exit slits:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} define the values of the parameters to scan}
\PYG{n}{energy}    \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{7201}\PYG{p}{,}\PYG{l+m+mi}{250}\PYG{p}{)}
\PYG{n}{SlitSize}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} define a list of dictionaries with the parameters to scan}
\PYG{n}{params} \PYG{o}{=} \PYG{p}{[}
            \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonEnergy}\PYG{p}{:}\PYG{n}{energy}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{ExitSlit}\PYG{o}{.}\PYG{n}{totalHeight}\PYG{p}{:}\PYG{n}{SlitSize}\PYG{p}{\PYGZcb{}}
        \PYG{p}{]}

\PYG{c+c1}{\PYGZsh{}and then plug them into the Simulation class}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{params}\PYG{o}{=}\PYG{n}{params}
\end{sphinxVerbatim}

\sphinxAtStartPar
It is also possible to define coupled parameters. If for instance, one wants
to increase the number of rays with the photon energy

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} define the values of the parameters to scan}
\PYG{n}{energy}    \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{200}\PYG{p}{,} \PYG{l+m+mi}{7201}\PYG{p}{,}\PYG{l+m+mi}{250}\PYG{p}{)}
\PYG{n}{nrays}     \PYG{o}{=} \PYG{n}{energy}\PYG{o}{*}\PYG{l+m+mi}{100}
\PYG{n}{SlitSize}  \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{array}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mf}{0.1}\PYG{p}{]}\PYG{p}{)}

\PYG{c+c1}{\PYGZsh{} define a list of dictionaries with the parameters to scan}
\PYG{n}{params} \PYG{o}{=} \PYG{p}{[}
            \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{photonEnergy}\PYG{p}{:}\PYG{n}{energy}\PYG{p}{,} \PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{o}{.}\PYG{n}{numberRays}\PYG{p}{:}\PYG{n}{nrays}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
            \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{ExitSlit}\PYG{o}{.}\PYG{n}{totalHeight}\PYG{p}{:}\PYG{n}{SlitSize}\PYG{p}{\PYGZcb{}}
        \PYG{p}{]}

\PYG{c+c1}{\PYGZsh{}and then plug them into the Simulation class}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{params}\PYG{o}{=}\PYG{n}{params}
\end{sphinxVerbatim}

\sphinxAtStartPar
The simulations files and the results will be saved in a folder called \sphinxtitleref{RAYPy\_simulation\_}
and a name of your choice, that can be set. This folder will be saved, by default,
in the folder where the program is executed, but it can eventually be modified

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{simulation\PYGZus{}folder} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{/home/raypy/Documents/simulations}\PYG{l+s+s1}{\PYGZsq{}}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{simulation\PYGZus{}name} \PYG{o}{=} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{test}\PYG{l+s+s1}{\PYGZsq{}}
\end{sphinxVerbatim}

\sphinxAtStartPar
This will create a simulation folder with the following path and name

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{o}{/}\PYG{n}{home}\PYG{o}{/}\PYG{n}{raypy}\PYG{o}{/}\PYG{n}{Documents}\PYG{o}{/}\PYG{n}{simulations}\PYG{o}{/}\PYG{n}{RAYPy\PYGZus{}simulation\PYGZus{}test}
\end{sphinxVerbatim}

\sphinxAtStartPar
Sometimes, instead of using millions of rays, it is more convenient to repeat the simulations and average the results
We can set which parameters of which optical elements can be exported. The number of rounds of simulations can be set like this:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{} repeat the simulations as many times as needed}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{repeat} \PYG{o}{=} \PYG{l+m+mi}{1}
\end{sphinxVerbatim}

\sphinxAtStartPar
One can decide whether want RAY\sphinxhyphen{}UI or raypyng to do a preliminary analysis of the results.
To let RAY\sphinxhyphen{}UI analyze the results, one has to set:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{analyze} \PYG{o}{=} \PYG{k+kc}{True} \PYG{c+c1}{\PYGZsh{} let RAY\PYGZhy{}UI analyze the results}
\end{sphinxVerbatim}

\sphinxAtStartPar
In this case, the following files are available to export:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{sim}\PYG{o}{.}\PYG{n}{possible\PYGZus{}exports}\PYG{p}{)}
\PYG{o}{\PYGZgt{}} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AnglePhiDistribution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{AnglePsiDistribution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{BeamPropertiesPlotSnapshot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{EnergyDistribution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintAbsorbedRays}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintAllRays}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintOutgoingRays}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintPlotSnapshot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{FootprintWastedRays}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IntensityPlotSnapshot}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IntensityX}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{IntensityYZ}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{PathlengthDistribution}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysBeam}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysIncoming}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysOutgoing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ScalarBeamProperties}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,}
\PYG{o}{\PYGZgt{}} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ScalarElementProperties}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
To let raypyng analyze the results set:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{analyze} \PYG{o}{=} \PYG{k+kc}{False} \PYG{c+c1}{\PYGZsh{} don\PYGZsq{}t let RAY\PYGZhy{}UI analyze the results}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{raypyng\PYGZus{}analysis}\PYG{o}{=}\PYG{k+kc}{True} \PYG{c+c1}{\PYGZsh{} let raypyng analyze the results}
\end{sphinxVerbatim}

\sphinxAtStartPar
In this case, only these exports are possible

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n+nb}{print}\PYG{p}{(}\PYG{n}{sim}\PYG{o}{.}\PYG{n}{possible\PYGZus{}exports\PYGZus{}without\PYGZus{}analysis}\PYG{p}{)}
\PYG{o}{\PYGZgt{}} \PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysIncoming}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysOutgoing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
The exports are available for each optical element in the beamline, ImagePlanes included, and can be set like this:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{c+c1}{\PYGZsh{}\PYGZsh{} This must be a list of dictionaries}
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{exports}  \PYG{o}{=}  \PYG{p}{[}\PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{Dipole}\PYG{p}{:}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ScalarElementProperties}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}\PYG{p}{,}
                \PYG{p}{\PYGZob{}}\PYG{n}{elisa}\PYG{o}{.}\PYG{n}{DetectorAtFocus}\PYG{p}{:}\PYG{p}{[}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ScalarBeamProperties}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{]}\PYG{p}{\PYGZcb{}}
                \PYG{p}{]}
\end{sphinxVerbatim}

\sphinxAtStartPar
Finally, the simulations can be run using

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{sim}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{multiprocessing}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{force}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
where the \sphinxtitleref{multiprocessing} parameter can be set either to False or to an int, corresponding to the number of parallel instances of RAY\sphinxhyphen{}UI to be used. Generally speaking, the number of instances of RAY\sphinxhyphen{}UI must be lower than the number of cores available. If the simulation uses many rays, monitor the RAM usage of your computer. If the computation uses all the possible RAM of the computer the program may get blocked or not execute correctly.


\subsection{Simulation Output}
\label{\detokenize{tutorial:simulation-output}}
\sphinxAtStartPar
Expect this folders and subfolders to be created:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
RAYPy\PYGZus{}simulation\PYGZus{}mySimulation
├── round\PYGZus{}0
│   ├── 0\PYGZus{}*.rml
│   └── 0\PYGZus{}*.csv
│   └── 0\PYGZus{}*.dat (only if raypyng analyzes the results)
│   └── ...
│   └── looper.py
...
├── round\PYGZus{}n
│   ├── 0\PYGZus{}*.rml
│   └── 0\PYGZus{}*.csv
│   └── 0\PYGZus{}*.dat (only if raypyng analyzes the results)
│   └── ...
│   └── looper.py
├── input\PYGZus{}param\PYGZus{}1.dat
...
├── input\PYGZus{}param\PYGZus{}k.dat
├── output\PYGZus{}simulation.dat (only if raypyng analyzes the results)
\end{sphinxVerbatim}


\subsubsection{Analysis performed by RAY\sphinxhyphen{}UI}
\label{\detokenize{tutorial:analysis-performed-by-ray-ui}}
\sphinxAtStartPar
If you decided to let RAY\sphinxhyphen{}UI do the analysis, you should expect the following files to be
saved in your simulation folder:
\begin{itemize}
\item {} 
\sphinxAtStartPar
one file for each parameter you set with the values that you passed to the program.
If for instance, you input the Dipole numberRays, you will find a file called
\sphinxtitleref{input\_param\_Dipole\_numberRays.dat}

\item {} 
\sphinxAtStartPar
one folder called \sphinxtitleref{round\_n} for each repetition of the simulations.
For instance, if you set \sphinxcode{\sphinxupquote{sim.repeat=2}} you will have two folders \sphinxtitleref{round\_0} and \sphinxtitleref{round\_1}

\item {} 
\sphinxAtStartPar
inside each \sphinxtitleref{round\_n} folder you will find the beamline files modified
with the parameters you set in \sphinxtitleref{sim.params}, these are the \sphinxtitleref{.rml} files,
that can be opened by RAY\sphinxhyphen{}UI.

\item {} 
\sphinxAtStartPar
inside each \sphinxtitleref{round\_n} folder you will find your exported files, one for
each simulation. If for instance, you exported the \sphinxtitleref{ScalarElementProperties} of the Dipole,
you will have a list of files \sphinxtitleref{0\_Dipole\sphinxhyphen{}ScalarElementProperties.csv}

\item {} 
\sphinxAtStartPar
\sphinxtitleref{looper.csv} each simulation and its parameters.

\end{itemize}


\subsubsection{Analysis performed by raypyng}
\label{\detokenize{tutorial:analysis-performed-by-raypyng}}
\sphinxAtStartPar
If you decided to let raypyng do the analysis, you should expect the following files to
be saved in your simulation folder:
\begin{itemize}
\item {} 
\sphinxAtStartPar
one file for each parameter you set with the values that you passed to the program.
If for instance, you input the Dipole numberRays, you will find a file called
\sphinxtitleref{input\_param\_Dipole\_numberRays.dat}

\item {} 
\sphinxAtStartPar
one folder called \sphinxtitleref{round\_n} for each repetition of the simulations.
For instance, if you set \sphinxcode{\sphinxupquote{sim.repeat=2}} you will have two folders \sphinxtitleref{round\_0} and \sphinxtitleref{round\_1}

\item {} 
\sphinxAtStartPar
inside each \sphinxtitleref{round\_n} folder you will find the beamline files modified with the parameters
you set in \sphinxtitleref{sim.params}, these are the \sphinxtitleref{.rml} files, that can be opened by RAY\sphinxhyphen{}UI.

\item {} 
\sphinxAtStartPar
inside each \sphinxtitleref{round\_n} folder you will find your exported files, one for each simulation.
If for instance, you exported the \sphinxtitleref{RawRaysOutgoing} of the Dipole, you will
have a list of files \sphinxtitleref{0\_Dipole\sphinxhyphen{}RawRaysOutgoing.csv}

\item {} 
\sphinxAtStartPar
for each \sphinxtitleref{RawRaysOutgoing} file, raypyng calculates some properties,
and saves a corresponding file, for instance \sphinxtitleref{0\_Dipole\_analyzed\_rays.dat}. Each of these files contains the following information:
\begin{itemize}
\item {} 
\sphinxAtStartPar
SourcePhotonFlux

\item {} 
\sphinxAtStartPar
NumberRaysSurvived

\item {} 
\sphinxAtStartPar
PercentageRaysSurvived

\item {} 
\sphinxAtStartPar
PhotonFlux

\item {} 
\sphinxAtStartPar
Bandwidth

\item {} 
\sphinxAtStartPar
HorizontalFocusFWHM

\item {} 
\sphinxAtStartPar
VerticalFocusFWHM

\end{itemize}

\item {} 
\sphinxAtStartPar
In the simulation folder, all the for each exported element
is united (and in case of more rounds of simulations averaged)
in one single file. For the dipole, the file is called \sphinxtitleref{Dipole.dat}

\item {} 
\sphinxAtStartPar
\sphinxtitleref{looper.csv} each simulation and its parameters.

\end{itemize}


\section{Recipes}
\label{\detokenize{tutorial:recipes}}
\sphinxAtStartPar
raypyng provides some recipes to make simulations,
that simplify the syntax in the script.
Two recipes are provided, one to make \sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_simulation\_RP.py}{Resolving Power} simulations,
one to make \sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_simulation\_Flux.py}{Flux}
simulations.


\section{List of available examples}
\label{\detokenize{tutorial:list-of-available-examples}}
\sphinxAtStartPar
In the example folder, the following examples are available:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_rml.py}{example\_rml.py}
in this example is shown how to read, manipulate and save an rml file.

\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_runner.py}{example\_runner.py}
in this example is shown how to use the RAY\sphinxhyphen{}UI API to start RAY\sphinxhyphen{}UI, load a file,
trace it and export the desired results.

\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_simulation\_analyze.py}{example\_simulation\_analyze.py} simulate a beamline,
let Ray\sphinxhyphen{}UI do the analysis

\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_simulation\_noanalyze.py}{example\_simulation\_noanalyze.py}
simulate a beamline,
let raypyng do the analysis

\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_eval\_noanalyze\_and\_analyze.py}{example\_eval\_noanalyze\_and\_analyze.py}
plots the results
of the two previous simulations

\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_simulation\_Flux.py}{example\_simulation\_Flux.py}
simulations using the flux recipe,
useful if you intend to simulate the flux of your beamline

\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_simulation\_RP.py}{example\_simulation\_RP.py}
simulations using the resolving power
(RP) recipe, useful if you intend to simulate the RP of your beamline.
The reflectivity of every optical element is switched to 100\% and not
calculated using the substrate and coating(s) material(s). The
information about the Flux of the beamline is therefore not reliable.

\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_beamwaist.py}{example\_beamwaist.py}
raypyng can plot the beam waist of
the x\sphinxhyphen{}rays across your beamline. It performs simulations using the beam waist recipe,
and it exports the RawRaysOutgoing file from each optical element. It then uses a
simple geometrical x\sphinxhyphen{}ray tracer to propagate each ray until the next optical
element and plots the results (both top view and side view). This is still
experimental and it may fail.

\item {} 
\sphinxAtStartPar
\sphinxhref{https://github.com/hz-b/raypyng/blob/main/examples/example\_rml.py}{example\_waveHelper.py}
The WaveHelper class can help to inspect a folder produced by \sphinxhref{https://www.helmholtz-berlin.de/forschung/oe/wi/undulators/arbeitsgebiete/wave\_en.html}{WAVE}
and provides a simple API to get the path of the simulation files depending on the harmonic and
on the energy.

\end{itemize}

\sphinxstepscope


\chapter{How To Guides}
\label{\detokenize{how_to:how-to-guides}}\label{\detokenize{how_to::doc}}
\sphinxAtStartPar
To simplify the scripting, especially when repetitive,
there is the possibility to write recipe for raypyng, to
perform simulations, and automatize some tasks.


\section{Write your own Recipe}
\label{\detokenize{how_to:write-your-own-recipe}}

\subsection{Recipe Template}
\label{\detokenize{how_to:recipe-template}}
\sphinxAtStartPar
This the template to use to write a recipe.
At the beginning of the file import
\sphinxcode{\sphinxupquote{SimulationRecipe}} from \sphinxcode{\sphinxupquote{raypyng}}
and define a the Simulation class as an empty dummy.
This will ensure that you have access to all the methods of the
\sphinxcode{\sphinxupquote{Simulation}} class.

\sphinxAtStartPar
A recipe should containe at least the \sphinxcode{\sphinxupquote{\_\_init\_\_()}}
method and three more methods: \sphinxcode{\sphinxupquote{params()}},
and \sphinxcode{\sphinxupquote{simulation\_name()}},
and they must have as an argument the simulate class.

\sphinxAtStartPar
Compose the simulation parameters in the \sphinxcode{\sphinxupquote{params}} method:
The simulation parameter must return a list of dictionaries,
where the keys of the dictionaries are parameters of on abject
present in the beamline, instances of \sphinxcode{\sphinxupquote{ParamElement}} class.
The items of the dictionary must be the values that the parameter should
assume for the simulations.

\sphinxAtStartPar
Compose the simulation parameters in the \sphinxcode{\sphinxupquote{params()}} method:
The \sphinxcode{\sphinxupquote{params()}} method must return a list of dictionaries.
The keys of the dictionaries are parameters of on abject
present in the beamline, instances of \sphinxcode{\sphinxupquote{ParamElement}} class.
The items of the dictionary must be the values that the parameter should
assume for the simulations.

\sphinxAtStartPar
Compose the export parameters in the \sphinxcode{\sphinxupquote{exports()}} method:
The The \sphinxcode{\sphinxupquote{exports()}} method must return a list of dictionaries,
method must return a list of dictionaries.
The keys of the dictionaries are parameters of on abject
present in the beamline, instances of \sphinxcode{\sphinxupquote{ParamElement}} class.
The items of the dictionary is the name of the file that you want to export
(print the output of \sphinxcode{\sphinxupquote{Simulation.possible\_exports}} and
\sphinxcode{\sphinxupquote{possible\_exports\_without\_analysis}}.

\sphinxAtStartPar
Define the name to give to the simulation folder
in \sphinxcode{\sphinxupquote{simulation\_name()}}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{from} \PYG{n+nn}{raypyng}\PYG{n+nn}{.}\PYG{n+nn}{recipes} \PYG{k+kn}{import} \PYG{n}{SimulationRecipe}

\PYG{k}{class} \PYG{n+nc}{Simulate}\PYG{p}{:} \PYG{k}{pass}

\PYG{k}{class} \PYG{n+nc}{MyRecipe}\PYG{p}{(}\PYG{n}{SimulationRecipe}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{pass}

    \PYG{k}{def} \PYG{n+nf}{params}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,}\PYG{n}{sim}\PYG{p}{:}\PYG{n}{Simulate}\PYG{p}{)}\PYG{p}{:}

        \PYG{n}{params} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

        \PYG{k}{return} \PYG{n}{params}

    \PYG{k}{def} \PYG{n+nf}{exports}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,}\PYG{n}{sim}\PYG{p}{:}\PYG{n}{Simulate}\PYG{p}{)}\PYG{p}{:}

        \PYG{n}{exports} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

        \PYG{k}{return} \PYG{n}{exports}

    \PYG{k}{def} \PYG{n+nf}{simulation\PYGZus{}name}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,}\PYG{n}{sim}\PYG{p}{:}\PYG{n}{Simulate}\PYG{p}{)}\PYG{p}{:}

        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sim\PYGZus{}folder} \PYG{o}{=} \PYG{o}{.}\PYG{o}{.}\PYG{o}{.}

        \PYG{k}{return} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sim\PYGZus{}folder}
\end{sphinxVerbatim}


\subsection{How To Write a Recipe}
\label{\detokenize{how_to:how-to-write-a-recipe}}
\sphinxAtStartPar
An example of how to write a recipe that exports
file for each element present in the beamline automatically.
\begin{quote}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k}{class} \PYG{n+nc}{ExportEachElement}\PYG{p}{(}\PYG{n}{SimulationRecipe}\PYG{p}{)}\PYG{p}{:}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}At one defined energy export a file for each}
\PYG{l+s+sd}{optical elements}
\PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{k}{def} \PYG{n+nf+fm}{\PYGZus{}\PYGZus{}init\PYGZus{}\PYGZus{}}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,} \PYG{n}{energy}\PYG{p}{:}\PYG{n+nb}{float}\PYG{p}{,}\PYG{o}{/}\PYG{p}{,}\PYG{n}{nrays}\PYG{p}{:}\PYG{n+nb}{int}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{,}\PYG{n}{sim\PYGZus{}folder}\PYG{p}{:}\PYG{n+nb}{str}\PYG{o}{=}\PYG{k+kc}{None}\PYG{p}{)}\PYG{p}{:}
    \PYG{l+s+sd}{\PYGZdq{}\PYGZdq{}\PYGZdq{}}
\PYG{l+s+sd}{    Args:}
\PYG{l+s+sd}{        energy\PYGZus{}range (np.array, list): the energies to simulate in eV}
\PYG{l+s+sd}{        nrays (int): number of rays for the source}
\PYG{l+s+sd}{        sim\PYGZus{}folder (str, optional): the name of the simulation folder. If None, the rml filename will be used. Defaults to None.}

\PYG{l+s+sd}{    \PYGZdq{}\PYGZdq{}\PYGZdq{}}

    \PYG{k}{if} \PYG{o+ow}{not} \PYG{n+nb}{isinstance}\PYG{p}{(}\PYG{n}{energy}\PYG{p}{,} \PYG{p}{(}\PYG{n+nb}{int}\PYG{p}{,}\PYG{n+nb}{float}\PYG{p}{)}\PYG{p}{)}\PYG{p}{:}
       \PYG{k}{raise} \PYG{n+ne}{TypeError}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{The energy must be an a int or float, while it is a}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n+nb}{type}\PYG{p}{(}\PYG{n}{energy}\PYG{p}{)}\PYG{p}{)}

    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy} \PYG{o}{=} \PYG{n}{energy}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{nrays}  \PYG{o}{=} \PYG{n}{nrays}
    \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sim\PYGZus{}folder} \PYG{o}{=} \PYG{n}{sim\PYGZus{}folder}

\PYG{k}{def} \PYG{n+nf}{params}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,}\PYG{n}{sim}\PYG{p}{:}\PYG{n}{Simulate}\PYG{p}{)}\PYG{p}{:}
    \PYG{n}{params} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}

    \PYG{c+c1}{\PYGZsh{} find source and add to param with defined user energy range}
    \PYG{n}{found\PYGZus{}source} \PYG{o}{=} \PYG{k+kc}{False}
    \PYG{k}{for} \PYG{n}{oe} \PYG{o+ow}{in} \PYG{n}{sim}\PYG{o}{.}\PYG{n}{rml}\PYG{o}{.}\PYG{n}{beamline}\PYG{o}{.}\PYG{n}{children}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
        \PYG{k}{if} \PYG{n+nb}{hasattr}\PYG{p}{(}\PYG{n}{oe}\PYG{p}{,}\PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{photonEnergy}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{)}\PYG{p}{:}
        \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{source} \PYG{o}{=} \PYG{n}{oe}
            \PYG{n}{found\PYGZus{}source} \PYG{o}{=} \PYG{k+kc}{True}
            \PYG{k}{break}
    \PYG{k}{if} \PYG{n}{found\PYGZus{}source}\PYG{o}{!=}\PYG{k+kc}{True}\PYG{p}{:}
        \PYG{k}{raise} \PYG{n+ne}{AttributeError}\PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{I did not find the source}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{params}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{source}\PYG{o}{.}\PYG{n}{photonEnergy}\PYG{p}{:}\PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{energy}\PYG{p}{\PYGZcb{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} set reflectivity to 100\PYGZpc{}}
    \PYG{k}{for} \PYG{n}{oe} \PYG{o+ow}{in} \PYG{n}{sim}\PYG{o}{.}\PYG{n}{rml}\PYG{o}{.}\PYG{n}{beamline}\PYG{o}{.}\PYG{n}{children}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
            \PYG{k}{for} \PYG{n}{par} \PYG{o+ow}{in} \PYG{n}{oe}\PYG{p}{:}
                \PYG{k}{try}\PYG{p}{:}
                    \PYG{n}{params}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{par}\PYG{o}{.}\PYG{n}{reflectivityType}\PYG{p}{:}\PYG{l+m+mi}{0}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
                \PYG{k}{except}\PYG{p}{:}
                    \PYG{k}{pass}

    \PYG{c+c1}{\PYGZsh{} all done, return resulting params}
    \PYG{k}{return} \PYG{n}{params}

\PYG{k}{def} \PYG{n+nf}{exports}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,}\PYG{n}{sim}\PYG{p}{:}\PYG{n}{Simulate}\PYG{p}{)}\PYG{p}{:}
    \PYG{c+c1}{\PYGZsh{} find all the elements in the beamline}
    \PYG{n}{oe\PYGZus{}list}\PYG{o}{=}\PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{oe} \PYG{o+ow}{in} \PYG{n}{sim}\PYG{o}{.}\PYG{n}{rml}\PYG{o}{.}\PYG{n}{beamline}\PYG{o}{.}\PYG{n}{children}\PYG{p}{(}\PYG{p}{)}\PYG{p}{:}
        \PYG{n}{oe\PYGZus{}list}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{n}{oe}\PYG{p}{)}
    \PYG{c+c1}{\PYGZsh{} compose the export list of dictionaries}
    \PYG{n}{exports} \PYG{o}{=} \PYG{p}{[}\PYG{p}{]}
    \PYG{k}{for} \PYG{n}{oe} \PYG{o+ow}{in} \PYG{n}{oe\PYGZus{}list}\PYG{p}{:}
        \PYG{n}{exports}\PYG{o}{.}\PYG{n}{append}\PYG{p}{(}\PYG{p}{\PYGZob{}}\PYG{n}{oe}\PYG{p}{:}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{RawRaysOutgoing}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{\PYGZcb{}}\PYG{p}{)}
    \PYG{k}{return} \PYG{n}{exports}

\PYG{k}{def} \PYG{n+nf}{simulation\PYGZus{}name}\PYG{p}{(}\PYG{n+nb+bp}{self}\PYG{p}{,}\PYG{n}{sim}\PYG{p}{:}\PYG{n}{Simulate}\PYG{p}{)}\PYG{p}{:}
    \PYG{k}{if} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sim\PYGZus{}folder} \PYG{o+ow}{is} \PYG{k+kc}{None}\PYG{p}{:}
        \PYG{k}{return} \PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{ExportEachElement}\PYG{l+s+s1}{\PYGZsq{}}
    \PYG{k}{else}\PYG{p}{:}
        \PYG{k}{return} \PYG{n+nb+bp}{self}\PYG{o}{.}\PYG{n}{sim\PYGZus{}folder}
\PYG{k}{if} \PYG{n+nv+vm}{\PYGZus{}\PYGZus{}name\PYGZus{}\PYGZus{}} \PYG{o}{==} \PYG{l+s+s2}{\PYGZdq{}}\PYG{l+s+s2}{\PYGZus{}\PYGZus{}main\PYGZus{}\PYGZus{}}\PYG{l+s+s2}{\PYGZdq{}}\PYG{p}{:}
    \PYG{k+kn}{from} \PYG{n+nn}{raypyng} \PYG{k+kn}{import} \PYG{n}{Simulate}
    \PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}
    \PYG{k+kn}{import} \PYG{n+nn}{os}

    \PYG{n}{rml\PYGZus{}file} \PYG{o}{=} \PYG{p}{(}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{rml\PYGZus{}file.rml}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}
    \PYG{n}{sim}      \PYG{o}{=} \PYG{n}{Simulate}\PYG{p}{(}\PYG{n}{rml\PYGZus{}file}\PYG{p}{,} \PYG{n}{hide}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}


    \PYG{n}{sim}\PYG{o}{.}\PYG{n}{analyze} \PYG{o}{=} \PYG{k+kc}{False}

    \PYG{n}{myRecipe} \PYG{o}{=} \PYG{n}{ExportEachElement}\PYG{p}{(}\PYG{n}{energy}\PYG{o}{=}\PYG{l+m+mi}{1000}\PYG{p}{,}\PYG{n}{nrays}\PYG{o}{=}\PYG{l+m+mi}{10000}\PYG{p}{,}\PYG{n}{sim\PYGZus{}folder}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{MyRecipeTest}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

    \PYG{c+c1}{\PYGZsh{} test resolving power simulations}
    \PYG{n}{sim}\PYG{o}{.}\PYG{n}{run}\PYG{p}{(}\PYG{n}{myRecipe}\PYG{p}{,} \PYG{n}{multiprocessing}\PYG{o}{=}\PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{force}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}
\end{quote}


\section{How to work with Undulator File}
\label{\detokenize{how_to:how-to-work-with-undulator-file}}
\sphinxAtStartPar
The \sphinxtitleref{WaveHelper} class helps to inspect a WAVE simulation folder and
provides a simple way to extract the absolute path of the simulation files
to feed to the \sphinxtitleref{Undulator File}. In this example we use the \sphinxtitleref{WAVE} folder provided in the example
folder at this \sphinxhref{https://github.com/hz-b/raypyng/tree/main/examples}{link}. Inside the folder there are
WAVE simulation files for the first, third and fifth harmonic, and the Undulator is called \sphinxtitleref{U49}

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{k+kn}{import} \PYG{n+nn}{numpy} \PYG{k}{as} \PYG{n+nn}{np}

\PYG{k+kn}{from} \PYG{n+nn}{raypyng}\PYG{n+nn}{.}\PYG{n+nn}{wave\PYGZus{}helper} \PYG{k+kn}{import} \PYG{n}{WaveHelper}

\PYG{n}{WH} \PYG{o}{=} \PYG{n}{WaveHelper}\PYG{p}{(}\PYG{n}{wave\PYGZus{}folder\PYGZus{}path}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{WAVE}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{,} \PYG{n}{harmonic}\PYG{o}{=}\PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{undulator}\PYG{o}{=}\PYG{l+s+s1}{\PYGZsq{}}\PYG{l+s+s1}{U49}\PYG{l+s+s1}{\PYGZsq{}}\PYG{p}{)}

\PYG{n}{WH}\PYG{o}{.}\PYG{n}{report\PYGZus{}available\PYGZus{}energies}\PYG{p}{(}\PYG{n}{verbose}\PYG{o}{=}\PYG{k+kc}{True}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
This produces the following output:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{I} \PYG{n}{found} \PYG{n}{the} \PYG{n}{following} \PYG{n}{harmonics}\PYG{p}{:} \PYG{n}{dict\PYGZus{}keys}\PYG{p}{(}\PYG{p}{[}\PYG{l+m+mi}{1}\PYG{p}{,} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{l+m+mi}{5}\PYG{p}{]}\PYG{p}{)}
\PYG{n}{the} \PYG{n}{energy} \PYG{n}{points} \PYG{k}{for} \PYG{n}{each} \PYG{n}{harmonic} \PYG{n}{are} \PYG{n}{equally} \PYG{n}{spaced}
\PYG{n}{Harmonic} \PYG{n}{number} \PYG{l+m+mi}{1}\PYG{p}{,} \PYG{n}{available} \PYG{n}{energies}\PYG{p}{:}
\PYG{n}{start} \PYG{l+m+mi}{80}
\PYG{n}{stop} \PYG{l+m+mi}{570}
\PYG{n}{step} \PYG{l+m+mi}{10}
\PYG{n}{Harmonic} \PYG{n}{number} \PYG{l+m+mi}{3}\PYG{p}{,} \PYG{n}{available} \PYG{n}{energies}\PYG{p}{:}
\PYG{n}{start} \PYG{l+m+mi}{240}
\PYG{n}{stop} \PYG{l+m+mi}{1710}
\PYG{n}{step} \PYG{l+m+mi}{30}
\PYG{n}{Harmonic} \PYG{n}{number} \PYG{l+m+mi}{5}\PYG{p}{,} \PYG{n}{available} \PYG{n}{energies}\PYG{p}{:}
\PYG{n}{start} \PYG{l+m+mi}{400}
\PYG{n}{stop} \PYG{l+m+mi}{2850}
\PYG{n}{step} \PYG{l+m+mi}{50}
\end{sphinxVerbatim}

\sphinxAtStartPar
We can now extract the file location for all the energies or a subset of the
energies available for the first harmonic of the undulator:

\begin{sphinxVerbatim}[commandchars=\\\{\}]
\PYG{n}{energies} \PYG{o}{=} \PYG{n}{np}\PYG{o}{.}\PYG{n}{arange}\PYG{p}{(}\PYG{l+m+mi}{80}\PYG{p}{,}\PYG{l+m+mi}{570}\PYG{p}{,}\PYG{l+m+mi}{10}\PYG{p}{)}
\PYG{n}{energy\PYGZus{}files} \PYG{o}{=} \PYG{n}{WH}\PYG{o}{.}\PYG{n}{convert\PYGZus{}energies\PYGZus{}to\PYGZus{}file\PYGZus{}list}\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{p}{,}\PYG{n}{energies}\PYG{p}{)}
\end{sphinxVerbatim}

\sphinxAtStartPar
\sphinxtitleref{energy\_files} contains the absolute path to the WAVE simulation file for each energy.
This can be used to change the energy of an Undulator by calling the parameter \sphinxtitleref{undulatorFile}.

\sphinxstepscope


\chapter{API}
\label{\detokenize{API:api}}\label{\detokenize{API::doc}}

\section{Simulation}
\label{\detokenize{API:simulation}}

\subsection{Simulate}
\label{\detokenize{API:simulate}}\index{Simulate (class in raypyng.simulate)@\spxentry{Simulate}\spxextra{class in raypyng.simulate}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.simulate.}}\sphinxbfcode{\sphinxupquote{Simulate}}}{\emph{\DUrole{n}{rml}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{hide}\DUrole{o}{=}\DUrole{default_value}{False}}, \emph{\DUrole{n}{ray\_path}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
A class that takes care of performing the simulations with RAY\sphinxhyphen{}UI
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rml}} (\sphinxstyleliteralemphasis{\sphinxupquote{RMLFile/string}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} string pointing to an rml file with
the beamline template, or an RMLFile
class object. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hide}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} force hiding of GUI leftovers, xvfb needs
to be installed. Defaults to False.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ray\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the path to the RAY\sphinxhyphen{}UI installation folder.
If None, the program will look for RAY\sphinxhyphen{}UI in
the standard installation paths.

\end{itemize}

\end{description}\end{quote}
\index{analyze (raypyng.simulate.Simulate property)@\spxentry{analyze}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.analyze}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{analyze}}}
\pysigstopsignatures
\sphinxAtStartPar
Turn on or off the RAY\sphinxhyphen{}UI analysis of the results.
The analysis of the results takes time, so turn it on only if needed
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
True: analysis on, False: analysis off

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{exports (raypyng.simulate.Simulate property)@\spxentry{exports}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.exports}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{exports}}}
\pysigstopsignatures
\sphinxAtStartPar
The files to export once the simulation is complete.

\sphinxAtStartPar
For a list of possible files check self.possible\_exports
and self.possible\_exports\_without\_analysis.
It is expected a list of dictionaries, and for each dictionary
the key is the element to be exported and the values are
the files to be exported

\end{fulllineitems}

\index{params (raypyng.simulate.Simulate property)@\spxentry{params}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.params}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{params}}}
\pysigstopsignatures
\sphinxAtStartPar
The parameters to scan, as a list of dictionaries.

\sphinxAtStartPar
For each dictionary the keys are the parameters elements of the beamline, and the values are the
values to be assigned.

\end{fulllineitems}

\index{path (raypyng.simulate.Simulate property)@\spxentry{path}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.path}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{path}}}
\pysigstopsignatures
\sphinxAtStartPar
The path where to execute the simlations
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
by default the path is the current path from which
the program is executed

\sphinxlineitem{Return type}
\sphinxAtStartPar
string

\end{description}\end{quote}

\end{fulllineitems}

\index{possible\_exports (raypyng.simulate.Simulate property)@\spxentry{possible\_exports}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.possible_exports}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{possible\_exports}}}
\pysigstopsignatures
\sphinxAtStartPar
A list of the files that can be exported by RAY\sphinxhyphen{}UI
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
list of the names of the possible exports for RAY\sphinxhyphen{}UI

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{possible\_exports\_without\_analysis (raypyng.simulate.Simulate property)@\spxentry{possible\_exports\_without\_analysis}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.possible_exports_without_analysis}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{possible\_exports\_without\_analysis}}}
\pysigstopsignatures
\sphinxAtStartPar
A list of the files that can be exported by RAY\sphinxhyphen{}UI when the
analysis option is turned off
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
list of the names of the possible exports for RAY\sphinxhyphen{}UI when analysis is off

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{raypyng\_analysis (raypyng.simulate.Simulate property)@\spxentry{raypyng\_analysis}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.raypyng_analysis}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{raypyng\_analysis}}}
\pysigstopsignatures
\sphinxAtStartPar
Turn on or off the RAYPyNG analysis of the results.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
True: analysis on, False: analysis off

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{reflectivity() (raypyng.simulate.Simulate method)@\spxentry{reflectivity()}\spxextra{raypyng.simulate.Simulate method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.reflectivity}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{reflectivity}}}{\emph{\DUrole{n}{reflectivity}\DUrole{o}{=}\DUrole{default_value}{True}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Switch the reflectivity of all the optical elements in the beamline on or off.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{reflectivity}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If \sphinxcode{\sphinxupquote{True}} the reflectivity is switched on,
if \sphinxcode{\sphinxupquote{False}} the reflectivity is switched off.
Defaults to True.

\end{description}\end{quote}

\end{fulllineitems}

\index{repeat (raypyng.simulate.Simulate property)@\spxentry{repeat}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.repeat}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{repeat}}}
\pysigstopsignatures
\sphinxAtStartPar
The simulations can be repeated an arbitrary number of times

\sphinxAtStartPar
If the statitcs are not good enough using 2 millions of rays is suggested
to repeat them instead of increasing the number of rays
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
the number of repetition of the simulations, by default is 1

\sphinxlineitem{Return type}
\sphinxAtStartPar
int

\end{description}\end{quote}

\end{fulllineitems}

\index{rml (raypyng.simulate.Simulate property)@\spxentry{rml}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.rml}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{rml}}}
\pysigstopsignatures
\sphinxAtStartPar
RMLFile object instantiated in init

\end{fulllineitems}

\index{rml\_list() (raypyng.simulate.Simulate method)@\spxentry{rml\_list()}\spxextra{raypyng.simulate.Simulate method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.rml_list}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{rml\_list}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
This function creates the folder structure and the rml files to simulate.

\sphinxAtStartPar
It requires the param to be set. Useful if one wants to create the simulation files
for a manual check before starting the simulations.

\end{fulllineitems}

\index{run() (raypyng.simulate.Simulate method)@\spxentry{run()}\spxextra{raypyng.simulate.Simulate method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.run}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{run}}}{\emph{\DUrole{n}{recipe}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{o}{/}}, \emph{\DUrole{n}{multiprocessing}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{force}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\sphinxAtStartPar
This method starts the simulations. params and exports need to be defined.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{recipe}} (\sphinxstyleliteralemphasis{\sphinxupquote{SimulationRecipe}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If using a recipee pass it as a parameter. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{multiprocessing}} (\sphinxstyleliteralemphasis{\sphinxupquote{boolint}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True all the cpus are used. If an integer n is provided, n cpus are used. Defaults to True.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{force}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True all the simlations are performed, even if the export files already exist. If False only the simlations for which are missing some exports are performed. Defaults to False.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{save\_parameters\_to\_file() (raypyng.simulate.Simulate method)@\spxentry{save\_parameters\_to\_file()}\spxextra{raypyng.simulate.Simulate method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.save_parameters_to_file}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{save\_parameters\_to\_file}}}{\emph{\DUrole{n}{dir}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Save user input parameters to file.

\sphinxAtStartPar
It takes the values from the SimulationParams class
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the folder where to save the parameters

\end{description}\end{quote}

\end{fulllineitems}

\index{simulation\_name (raypyng.simulate.Simulate property)@\spxentry{simulation\_name}\spxextra{raypyng.simulate.Simulate property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.Simulate.simulation_name}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{simulation\_name}}}
\pysigstopsignatures
\sphinxAtStartPar
A string to append to the folder where the simulations will be executed.

\end{fulllineitems}


\end{fulllineitems}



\subsection{SimulationParams}
\label{\detokenize{API:simulationparams}}\index{SimulationParams (class in raypyng.simulate)@\spxentry{SimulationParams}\spxextra{class in raypyng.simulate}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.SimulationParams}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.simulate.}}\sphinxbfcode{\sphinxupquote{SimulationParams}}}{\emph{\DUrole{n}{rml}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{param\_list}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
The entry point of the simulation parameters.

\sphinxAtStartPar
A class that takes care of the simulations parameters,
makes sure that they are written correctly,
and returns the the list of simulations that is requested by the user.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rml}} (\sphinxstyleliteralemphasis{\sphinxupquote{RMLFile/string}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} string pointing to an rml
file with the beamline template,
or an RMLFile class object.
Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{param\_list}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} list of dictionaries containing the
parameters and values to simulate.
Defaults to None.

\end{itemize}

\end{description}\end{quote}
\index{params (raypyng.simulate.SimulationParams property)@\spxentry{params}\spxextra{raypyng.simulate.SimulationParams property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.SimulationParams.params}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{params}}}
\pysigstopsignatures
\sphinxAtStartPar
The parameters to scan, as a list of dictionaries.
For each dictionary the keys are the parameters elements of the beamline, and the values are the
values to be assigned.

\end{fulllineitems}

\index{rml (raypyng.simulate.SimulationParams property)@\spxentry{rml}\spxextra{raypyng.simulate.SimulationParams property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.simulate.SimulationParams.rml}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{rml}}}
\pysigstopsignatures
\sphinxAtStartPar
RMLFile object instantiated in init

\end{fulllineitems}


\end{fulllineitems}



\subsection{WaveHelper}
\label{\detokenize{API:wavehelper}}
\sphinxAtStartPar
Some source in RAY\sphinxhyphen{}UI can take as an input a file obtained by simulating the
insertion device with WAVE. This class inspects the folder where the WAVES results are
stored and provides a simple way to get a list of absolute paths to the simulation files.
\index{WaveHelper (class in raypyng.wave\_helper)@\spxentry{WaveHelper}\spxextra{class in raypyng.wave\_helper}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.wave_helper.WaveHelper}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.wave\_helper.}}\sphinxbfcode{\sphinxupquote{WaveHelper}}}{\emph{\DUrole{n}{wave\_folder\_path}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{harmonics}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{int}}, \emph{\DUrole{n}{undulator}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Explore WAVE simulation folder and gives an easy way to convert energies into filenames

\sphinxAtStartPar
The class expects the WAVE simulations to be stored in a folder called WAVE.
For instance for an undulator called ‘U49’ and harmonic=3, this filestructure is expected:
\begin{itemize}
\item {} \begin{description}
\sphinxlineitem{Wave}\begin{itemize}
\item {} 
\sphinxAtStartPar
U49H1allrayfiles

\item {} 
\sphinxAtStartPar
U49H3allrayfiles

\item {} 
\sphinxAtStartPar
U49H5allrayfiles

\end{itemize}
\begin{description}
\sphinxlineitem{Args:}
\sphinxAtStartPar
wave\_folder\_path (str): the path to the WAVW folder where the WAVE simulations are stored
harmonics (int): the number of harmonics present.(If harmonics=2, simulations for 1st and 3rd should exist)
undulator (str): the undulator name as indicated in the simulation folders

\end{description}

\end{description}

\end{itemize}
\index{convert\_energies\_to\_file\_list() (raypyng.wave\_helper.WaveHelper method)@\spxentry{convert\_energies\_to\_file\_list()}\spxextra{raypyng.wave\_helper.WaveHelper method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.wave_helper.WaveHelper.convert_energies_to_file_list}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{convert\_energies\_to\_file\_list}}}{\emph{\DUrole{n}{harmonic}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{int}}, \emph{\DUrole{n}{energies}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{list}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Takes the harmonic and a list of energies and returns the files location
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{harmonic}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the harmonic that you want to have

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{energies}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} list of int, the x\sphinxhyphen{}ray energies

\end{itemize}

\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ValueError}} \textendash{} If an energy is not present in the WAVE simulation folder.

\sphinxlineitem{Returns}
\sphinxAtStartPar
list of absolute paths for each energy given as an input

\sphinxlineitem{Return type}
\sphinxAtStartPar
list

\end{description}\end{quote}

\end{fulllineitems}

\index{report\_available\_energies() (raypyng.wave\_helper.WaveHelper method)@\spxentry{report\_available\_energies()}\spxextra{raypyng.wave\_helper.WaveHelper method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.wave_helper.WaveHelper.report_available_energies}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{report\_available\_energies}}}{\emph{\DUrole{n}{verbose}\DUrole{o}{=}\DUrole{default_value}{True}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Report about the availbale energies and explore the WAVE folder
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{verbose}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If Ture a report about the neergie is printed. Defaults to True.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{Recipes}
\label{\detokenize{API:recipes}}

\subsection{Resolving Power}
\label{\detokenize{API:resolving-power}}\index{ResolvingPower (class in raypyng.recipes)@\spxentry{ResolvingPower}\spxextra{class in raypyng.recipes}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.recipes.ResolvingPower}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.recipes.}}\sphinxbfcode{\sphinxupquote{ResolvingPower}}}{\emph{\DUrole{n}{energy\_range}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{range}}, \emph{\DUrole{n}{exported\_object}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{{\hyperref[\detokenize{API:raypyng.rml.ObjectElement}]{\sphinxcrossref{ObjectElement}}}}}, \emph{\DUrole{o}{/}}, \emph{\DUrole{o}{*}\DUrole{n}{args}}, \emph{\DUrole{n}{source}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}{\hyperref[\detokenize{API:raypyng.rml.ObjectElement}]{\sphinxcrossref{ObjectElement}}}\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{sim\_folder}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Recipe for resolving power simulations.

\sphinxAtStartPar
The eflectivity is automatically switched off for all elements,
the source if automatically recognized.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{energy\_range}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} the energies to simulate in eV

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{exported\_object}} ({\hyperref[\detokenize{API:raypyng.rml.ObjectElement}]{\sphinxcrossref{\sphinxstyleliteralemphasis{\sphinxupquote{ObjectElement}}}}}) \textendash{} the object to export

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{source}} ({\hyperref[\detokenize{API:raypyng.rml.ObjectElement}]{\sphinxcrossref{\sphinxstyleliteralemphasis{\sphinxupquote{ObjectElement}}}}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the source object.
If None is provided, an automatic recogniton
of the source will be tried. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sim\_folder}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the name of the simulation folder. If None, the rml
filename will be used. Defaults to None.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\subsection{Flux}
\label{\detokenize{API:flux}}\index{Flux (class in raypyng.recipes)@\spxentry{Flux}\spxextra{class in raypyng.recipes}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.recipes.Flux}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.recipes.}}\sphinxbfcode{\sphinxupquote{Flux}}}{\emph{\DUrole{n}{energy\_range}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{range}}, \emph{\DUrole{n}{exported\_object}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{{\hyperref[\detokenize{API:raypyng.rml.ObjectElement}]{\sphinxcrossref{ObjectElement}}}}}, \emph{\DUrole{o}{/}}, \emph{\DUrole{o}{*}\DUrole{n}{args}}, \emph{\DUrole{n}{source}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}{\hyperref[\detokenize{API:raypyng.rml.ObjectElement}]{\sphinxcrossref{ObjectElement}}}\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{sim\_folder}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Recipe for flux simulations.

\sphinxAtStartPar
The reflectivity is automatically switched on for all elements,
and the source is automatically identified.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{energy\_range}} (\sphinxstyleliteralemphasis{\sphinxupquote{np.array}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{list}}) \textendash{} the energies to simulate in eV

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{exported\_object}} ({\hyperref[\detokenize{API:raypyng.rml.ObjectElement}]{\sphinxcrossref{\sphinxstyleliteralemphasis{\sphinxupquote{ObjectElement}}}}}) \textendash{} the object to export

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{source}} ({\hyperref[\detokenize{API:raypyng.rml.ObjectElement}]{\sphinxcrossref{\sphinxstyleliteralemphasis{\sphinxupquote{ObjectElement}}}}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the source object.
If None is provided, an automatic recogniton
of the source will be tried. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sim\_folder}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the name of the simulation folder. If None, the rml
filename will be used. Defaults to None.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}



\section{Process simulation files}
\label{\detokenize{API:process-simulation-files}}

\subsection{PostProcess rays analyzed by raypyng}
\label{\detokenize{API:postprocess-rays-analyzed-by-raypyng}}\index{PostProcess (class in raypyng.postprocessing)@\spxentry{PostProcess}\spxextra{class in raypyng.postprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.PostProcess}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.postprocessing.}}\sphinxbfcode{\sphinxupquote{PostProcess}}}
\pysigstopsignatures
\sphinxAtStartPar
class to post\sphinxhyphen{}process the data.

\sphinxAtStartPar
It works only if the exported data are RawRaysOutgoing
\index{cleanup() (raypyng.postprocessing.PostProcess method)@\spxentry{cleanup()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.PostProcess.cleanup}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{cleanup}}}{\emph{\DUrole{n}{dir\_path}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{repeat}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{int}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{1}}, \emph{\DUrole{n}{exp\_elements}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}list\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Reads all the results of the postprocessing process and summarize
them in a single file for each exported object.

\sphinxAtStartPar
This functions reads all the temporary files created by \sphinxcode{\sphinxupquote{self.postptocess\_RawRays()}}
saves one file for each exported element in dir\_path, and deletes the temporary files.
If more than one round of simulations was done, the values are averaged.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} The path to the folder to cleanup. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{repeat}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} number of rounds of simulations. Defaults to 1.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{exp\_elements}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the exported elements names as str. Defaults to None.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{extract\_nrays\_from\_source() (raypyng.postprocessing.PostProcess method)@\spxentry{extract\_nrays\_from\_source()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.PostProcess.extract_nrays_from_source}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{extract\_nrays\_from\_source}}}{\emph{\DUrole{n}{rml\_filename}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Extract photon flux from rml file, find source automatically
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rml\_filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the rml file to use to extract the photon flux

\sphinxlineitem{Returns}
\sphinxAtStartPar
the photon flux

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{postprocess\_RawRays() (raypyng.postprocessing.PostProcess method)@\spxentry{postprocess\_RawRays()}\spxextra{raypyng.postprocessing.PostProcess method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.PostProcess.postprocess_RawRays}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{postprocess\_RawRays}}}{\emph{\DUrole{n}{exported\_element}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{exported\_object}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{dir\_path}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{sim\_number}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{n}{rml\_filename}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
PostProcess rountine of the RawRaysOutgoing extracted files.

\sphinxAtStartPar
The method looks in the folder dir\_path for a file with the filename:
\sphinxcode{\sphinxupquote{filename = os.path.join(dir\_path,sim\_number+exported\_element + \textquotesingle{}\sphinxhyphen{}\textquotesingle{} + exported\_object+\textquotesingle{}.csv\textquotesingle{})}}
for each file it calculates the number of rays, the bandwidth, and the horizontal and vertical focus size,
it saves it in an array that is composed by \sphinxcode{\sphinxupquote{{[}n\_rays,bandwidth,hor\_focus,vert\_focus{]}}}, that is then saved to
\sphinxcode{\sphinxupquote{os.path.join(dir\_path, sim\_number+exported\_element+\textquotesingle{}\_analyzed\_rays.npy\textquotesingle{})}}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{exported\_element}} (\sphinxstyleliteralemphasis{\sphinxupquote{list}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} a list of containing the exported elements name as str. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{exported\_object}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the exported object, tested only with RawRaysOutgoing. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{dir\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the folder where the file to process is located. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{sim\_number}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the prefix of the file, that is the simulation number with a \_prepended, ie \sphinxtitleref{0\_}. Defaults to None.

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{PostProcess rays analyzed by RAY\sphinxhyphen{}UI}
\label{\detokenize{API:postprocess-rays-analyzed-by-ray-ui}}\index{PostProcessAnalyzed (class in raypyng.postprocessing)@\spxentry{PostProcessAnalyzed}\spxextra{class in raypyng.postprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.PostProcessAnalyzed}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.postprocessing.}}\sphinxbfcode{\sphinxupquote{PostProcessAnalyzed}}}
\pysigstopsignatures
\sphinxAtStartPar
class to analyze the data exported by RAY\sphinxhyphen{}UI
\index{moving\_average() (raypyng.postprocessing.PostProcessAnalyzed method)@\spxentry{moving\_average()}\spxextra{raypyng.postprocessing.PostProcessAnalyzed method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.PostProcessAnalyzed.moving_average}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{moving\_average}}}{\emph{\DUrole{n}{x}}, \emph{\DUrole{n}{w}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Computes the morivng average with window w on the array x
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{x}} (\sphinxstyleliteralemphasis{\sphinxupquote{array}}) \textendash{} the array to average

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{w}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the window for the moving average

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
the x array once the moving average was applied

\sphinxlineitem{Return type}
\sphinxAtStartPar
np.array

\end{description}\end{quote}

\end{fulllineitems}

\index{retrieve\_bw\_and\_focusSize() (raypyng.postprocessing.PostProcessAnalyzed method)@\spxentry{retrieve\_bw\_and\_focusSize()}\spxextra{raypyng.postprocessing.PostProcessAnalyzed method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.PostProcessAnalyzed.retrieve_bw_and_focusSize}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{retrieve\_bw\_and\_focusSize}}}{\emph{\DUrole{n}{folder\_name}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{oe}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{nsimulations}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{int}}, \emph{\DUrole{n}{rounds}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{int}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Extract the bandwidth and focus size from ScalarBeamProperties of an object.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{folder\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the path to the folder where the simulations are

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{oe}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the optical element name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nsimulations}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the number of simulations

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rounds}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the number of rounds of simulations

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
the bandwidth
foc\_x np.array: the horizontal focus
foc\_y np.array: the vertical focus

\sphinxlineitem{Return type}
\sphinxAtStartPar
bw np.array

\end{description}\end{quote}

\end{fulllineitems}

\index{retrieve\_flux\_beamline() (raypyng.postprocessing.PostProcessAnalyzed method)@\spxentry{retrieve\_flux\_beamline()}\spxextra{raypyng.postprocessing.PostProcessAnalyzed method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.PostProcessAnalyzed.retrieve_flux_beamline}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{retrieve\_flux\_beamline}}}{\emph{\DUrole{n}{folder\_name}}, \emph{\DUrole{n}{source}}, \emph{\DUrole{n}{oe}}, \emph{\DUrole{n}{nsimulations}}, \emph{\DUrole{n}{rounds}\DUrole{o}{=}\DUrole{default_value}{1}}, \emph{\DUrole{n}{current}\DUrole{o}{=}\DUrole{default_value}{0.3}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Extract the flux from object ScalarBeamProperties and from source ScalarElementProperties.

\sphinxAtStartPar
This function takes as arguments the name of the
simulation folder, the exported objet in RAY\sphinxhyphen{}UI and there
number of simulations and returns the flux at the optical element in
percentage and in number of photons, and the flux produced
by the dipole.
It requires ScalarBeamProperties to be exported for the desired optical element,
if the source is a dipole it requires ScalarElementProperties to be exported for the Dipole
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{folder\_name}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the path to the folder where the simulations are

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{source}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the source name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{oe}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} the optical element name

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{nsimulations}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the number of simulations

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rounds}} (\sphinxstyleliteralemphasis{\sphinxupquote{int}}) \textendash{} the number of rounds of simulations

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{current}} (\sphinxstyleliteralemphasis{\sphinxupquote{float}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the ring current in Ampere. Defaults to 0.3.

\end{itemize}

\sphinxlineitem{Returns}
\sphinxAtStartPar
\begin{description}
\sphinxlineitem{photon\_flux (np.array)}{[}the photon flux at the optical element{]}
\sphinxAtStartPar
flux\_percent (np.array) : the photon flux in percentage relative to the source
source\_Photon\_flux (np.array) : the photon flux of the source

\sphinxlineitem{else:}
\sphinxAtStartPar
flux\_percent (np.array) : the photon flux in percentage relative to the source

\end{description}


\sphinxlineitem{Return type}
\sphinxAtStartPar
if the source is a Dipole

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{RayProperties}
\label{\detokenize{API:rayproperties}}\index{RayProperties (class in raypyng.postprocessing)@\spxentry{RayProperties}\spxextra{class in raypyng.postprocessing}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.RayProperties}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.postprocessing.}}\sphinxbfcode{\sphinxupquote{RayProperties}}}{\emph{\DUrole{n}{input}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}ndarray\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{o}{/}}, \emph{\DUrole{n}{filename}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
RayProperties class privides simplified interface to access results of the
postprocessing of calculated rays and provides functions to read and write those results
into a txt file, including the header
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{input}} (\sphinxstyleliteralemphasis{\sphinxupquote{nd.array}}) \textendash{} create RayProperties from an array. Intentende for internal use only!

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} file name to load the data from (including the header information/row)

\end{itemize}

\end{description}\end{quote}
\index{concat() (raypyng.postprocessing.RayProperties method)@\spxentry{concat()}\spxextra{raypyng.postprocessing.RayProperties method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.RayProperties.concat}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{concat}}}{\emph{\DUrole{n}{other}}}{}
\pysigstopsignatures
\sphinxAtStartPar
concatenate another instalnce of RayProperties and return a new object
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{other}} ({\hyperref[\detokenize{API:raypyng.postprocessing.RayProperties}]{\sphinxcrossref{\sphinxstyleliteralemphasis{\sphinxupquote{RayProperties}}}}}) \textendash{} instance of RayProperties to be contated to this instance

\sphinxlineitem{Returns}
\sphinxAtStartPar
resulting RayProperties object

\sphinxlineitem{Return type}
\sphinxAtStartPar
{\hyperref[\detokenize{API:raypyng.postprocessing.RayProperties}]{\sphinxcrossref{RayProperties}}}

\end{description}\end{quote}

\end{fulllineitems}

\index{save() (raypyng.postprocessing.RayProperties method)@\spxentry{save()}\spxextra{raypyng.postprocessing.RayProperties method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.postprocessing.RayProperties.save}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{save}}}{\emph{\DUrole{n}{filename}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Save current object into tab\sphinxhyphen{}separated file with header row
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{\_type\_}}) \textendash{} \_description\_

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{RAY\sphinxhyphen{}UI API}
\label{\detokenize{API:ray-ui-api}}

\subsection{RayUIRunner}
\label{\detokenize{API:rayuirunner}}\index{RayUIRunner (class in raypyng.runner)@\spxentry{RayUIRunner}\spxextra{class in raypyng.runner}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIRunner}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.runner.}}\sphinxbfcode{\sphinxupquote{RayUIRunner}}}{\emph{\DUrole{n}{ray\_path}\DUrole{o}{=}\DUrole{default_value}{None}}, \emph{\DUrole{n}{ray\_binary}\DUrole{o}{=}\DUrole{default_value}{\textquotesingle{}rayui.sh\textquotesingle{}}}, \emph{\DUrole{n}{background}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{n}{hide}\DUrole{o}{=}\DUrole{default_value}{False}}}{}
\pysigstopsignatures
\sphinxAtStartPar
RayUIRunner class implements all logic to start a RayUI process, load and rml file, trace and export.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ray\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the path to the RAY\sphinxhyphen{}UI installation folder.
Defaults to config.ray\_path, that will look for the
ray\_path in the standard installation folders.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{ray\_binary}} (\sphinxstyleliteralemphasis{\sphinxupquote{\_type\_}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} the binary file of RAY\sphinxhyphen{}UI.
Defaults to “rayui.sh”.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{background}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} activate background mode. Defaults to True.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{hide}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} Hide the RAY\sphinxhyphen{}UI graphical instances.
Available only if xvfb is installed.
Defaults to False.

\end{itemize}

\end{description}\end{quote}
\index{isrunning (raypyng.runner.RayUIRunner property)@\spxentry{isrunning}\spxextra{raypyng.runner.RayUIRunner property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIRunner.isrunning}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{isrunning}}}
\pysigstopsignatures
\sphinxAtStartPar
Check weather a process is running and rerutn a boolean
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
returns True if the process is running, otherwise False

\sphinxlineitem{Return type}
\sphinxAtStartPar
bool

\end{description}\end{quote}

\end{fulllineitems}

\index{kill() (raypyng.runner.RayUIRunner method)@\spxentry{kill()}\spxextra{raypyng.runner.RayUIRunner method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIRunner.kill}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{kill}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
kill a RAY\sphinxhyphen{}UI process

\end{fulllineitems}

\index{pid (raypyng.runner.RayUIRunner property)@\spxentry{pid}\spxextra{raypyng.runner.RayUIRunner property}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIRunner.pid}}
\pysigstartsignatures
\pysigline{\sphinxbfcode{\sphinxupquote{property\DUrole{w}{  }}}\sphinxbfcode{\sphinxupquote{pid}}}
\pysigstopsignatures
\sphinxAtStartPar
Get process id of the RayUI process
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
PID of the process if it running, None otherwise

\sphinxlineitem{Return type}
\sphinxAtStartPar
int

\end{description}\end{quote}

\end{fulllineitems}

\index{run() (raypyng.runner.RayUIRunner method)@\spxentry{run()}\spxextra{raypyng.runner.RayUIRunner method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIRunner.run}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{run}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Open one instance of RAY\sphinxhyphen{}UI using subprocess
\begin{quote}\begin{description}
\sphinxlineitem{Raises}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{RayPyRunnerError}} \textendash{} if the RAY\sphinxhyphen{}UI executable is not found raise an error

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{RayUIAPI}
\label{\detokenize{API:rayuiapi}}\index{RayUIAPI (class in raypyng.runner)@\spxentry{RayUIAPI}\spxextra{class in raypyng.runner}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIAPI}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.runner.}}\sphinxbfcode{\sphinxupquote{RayUIAPI}}}{\emph{\DUrole{n}{runner}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}{\hyperref[\detokenize{API:raypyng.runner.RayUIRunner}]{\sphinxcrossref{RayUIRunner}}}\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
RayUIAPI class implements (hopefully all) command interface of the RAY\sphinxhyphen{}UI
\index{export() (raypyng.runner.RayUIAPI method)@\spxentry{export()}\spxextra{raypyng.runner.RayUIAPI method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIAPI.export}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{export}}}{\emph{\DUrole{n}{objects}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{parameters}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{export\_path}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{data\_prefix}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Export simulation results from RAY\sphinxhyphen{}UI.
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{objects}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} string with objects list, e.g. “Dipole,DetectorAtFocus”

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{parameters}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} stromg with parameters to export, e.g. “ScalarBeamProperties,ScalarElementProperties”

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{export\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} path where to save the data

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{data\_prefix}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} prefix for the putput files

\end{itemize}

\end{description}\end{quote}

\end{fulllineitems}

\index{load() (raypyng.runner.RayUIAPI method)@\spxentry{load()}\spxextra{raypyng.runner.RayUIAPI method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIAPI.load}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{load}}}{\emph{\DUrole{n}{rml\_path}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Load an rml file
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rml\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}) \textendash{} path to the rml file

\end{description}\end{quote}

\end{fulllineitems}

\index{quit() (raypyng.runner.RayUIAPI method)@\spxentry{quit()}\spxextra{raypyng.runner.RayUIAPI method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIAPI.quit}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{quit}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
quit RAY\sphinxhyphen{}UI if it is running

\end{fulllineitems}

\index{save() (raypyng.runner.RayUIAPI method)@\spxentry{save()}\spxextra{raypyng.runner.RayUIAPI method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIAPI.save}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{save}}}{\emph{\DUrole{n}{rml\_path}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Save an rml file
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{rml\_path}} (\sphinxstyleliteralemphasis{\sphinxupquote{path}}) \textendash{} path to save the rml file

\end{description}\end{quote}

\end{fulllineitems}

\index{trace() (raypyng.runner.RayUIAPI method)@\spxentry{trace()}\spxextra{raypyng.runner.RayUIAPI method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.runner.RayUIAPI.trace}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{trace}}}{\emph{\DUrole{n}{analyze}\DUrole{o}{=}\DUrole{default_value}{True}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Trace an rml file (must have been loaded before).
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{analyze}} (\sphinxstyleliteralemphasis{\sphinxupquote{bool}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} If True RAY\sphinxhyphen{}UI will perform analysis of the rays.
Defaults to True.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\section{RML}
\label{\detokenize{API:rml}}

\subsection{RMLFile}
\label{\detokenize{API:rmlfile}}\index{RMLFile (class in raypyng.rml)@\spxentry{RMLFile}\spxextra{class in raypyng.rml}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.RMLFile}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.rml.}}\sphinxbfcode{\sphinxupquote{RMLFile}}}{\emph{\DUrole{n}{filename}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}, \emph{\DUrole{o}{/}}, \emph{\DUrole{n}{template}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Read/Write wrapper for the Ray RML files
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{filename}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} path to rml file. Defaults to None.

\item {} 
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{template}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} path to rml file to use as template.
Defaults to None.

\end{itemize}

\end{description}\end{quote}
\index{read() (raypyng.rml.RMLFile method)@\spxentry{read()}\spxextra{raypyng.rml.RMLFile method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.RMLFile.read}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{read}}}{\emph{\DUrole{n}{file}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Read rml file
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{file}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} file name to read. If set to None will use template file name defined during initilizatino of the class. Defaults to None.

\end{description}\end{quote}

\end{fulllineitems}

\index{write() (raypyng.rml.RMLFile method)@\spxentry{write()}\spxextra{raypyng.rml.RMLFile method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.RMLFile.write}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{write}}}{\emph{\DUrole{n}{file}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{Optional\DUrole{p}{{[}}str\DUrole{p}{{]}}}\DUrole{w}{  }\DUrole{o}{=}\DUrole{w}{  }\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Write the rml to \sphinxcode{\sphinxupquote{file}}
\begin{quote}\begin{description}
\sphinxlineitem{Parameters}
\sphinxAtStartPar
\sphinxstyleliteralstrong{\sphinxupquote{file}} (\sphinxstyleliteralemphasis{\sphinxupquote{str}}\sphinxstyleliteralemphasis{\sphinxupquote{, }}\sphinxstyleliteralemphasis{\sphinxupquote{optional}}) \textendash{} filename . Defaults to None.

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{BeamlineElement}
\label{\detokenize{API:beamlineelement}}\index{BeamlineElement (class in raypyng.rml)@\spxentry{BeamlineElement}\spxextra{class in raypyng.rml}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.BeamlineElement}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.rml.}}\sphinxbfcode{\sphinxupquote{BeamlineElement}}}{\emph{\DUrole{n}{name}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{attributes}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{dict}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures\index{add\_cdata() (raypyng.rml.BeamlineElement method)@\spxentry{add\_cdata()}\spxextra{raypyng.rml.BeamlineElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.BeamlineElement.add_cdata}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{add\_cdata}}}{\emph{\DUrole{n}{cdata}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Store cdata

\end{fulllineitems}

\index{add\_child() (raypyng.rml.BeamlineElement method)@\spxentry{add\_child()}\spxextra{raypyng.rml.BeamlineElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.BeamlineElement.add_child}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{add\_child}}}{\emph{\DUrole{n}{element}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Store child elements.

\end{fulllineitems}

\index{get\_attribute() (raypyng.rml.BeamlineElement method)@\spxentry{get\_attribute()}\spxextra{raypyng.rml.BeamlineElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.BeamlineElement.get_attribute}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_attribute}}}{\emph{\DUrole{n}{key}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Get attributes by key

\end{fulllineitems}

\index{get\_elements() (raypyng.rml.BeamlineElement method)@\spxentry{get\_elements()}\spxextra{raypyng.rml.BeamlineElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.BeamlineElement.get_elements}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_elements}}}{\emph{\DUrole{n}{name}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Find a child element by name

\end{fulllineitems}

\index{get\_full\_path() (raypyng.rml.BeamlineElement method)@\spxentry{get\_full\_path()}\spxextra{raypyng.rml.BeamlineElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.BeamlineElement.get_full_path}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_full\_path}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Returns the full path of the xml object
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
path of the xml object

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{resolvable\_name() (raypyng.rml.BeamlineElement method)@\spxentry{resolvable\_name()}\spxextra{raypyng.rml.BeamlineElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.BeamlineElement.resolvable_name}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{resolvable\_name}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Returns the name of the objects, removing lab.beamline.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
name of the object

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{ObjectElement}
\label{\detokenize{API:objectelement}}\index{ObjectElement (class in raypyng.rml)@\spxentry{ObjectElement}\spxextra{class in raypyng.rml}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ObjectElement}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.rml.}}\sphinxbfcode{\sphinxupquote{ObjectElement}}}{\emph{\DUrole{n}{name}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{attributes}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{dict}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures\index{add\_cdata() (raypyng.rml.ObjectElement method)@\spxentry{add\_cdata()}\spxextra{raypyng.rml.ObjectElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ObjectElement.add_cdata}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{add\_cdata}}}{\emph{\DUrole{n}{cdata}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Store cdata

\end{fulllineitems}

\index{add\_child() (raypyng.rml.ObjectElement method)@\spxentry{add\_child()}\spxextra{raypyng.rml.ObjectElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ObjectElement.add_child}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{add\_child}}}{\emph{\DUrole{n}{element}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Store child elements.

\end{fulllineitems}

\index{get\_attribute() (raypyng.rml.ObjectElement method)@\spxentry{get\_attribute()}\spxextra{raypyng.rml.ObjectElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ObjectElement.get_attribute}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_attribute}}}{\emph{\DUrole{n}{key}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Get attributes by key

\end{fulllineitems}

\index{get\_elements() (raypyng.rml.ObjectElement method)@\spxentry{get\_elements()}\spxextra{raypyng.rml.ObjectElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ObjectElement.get_elements}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_elements}}}{\emph{\DUrole{n}{name}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Find a child element by name

\end{fulllineitems}

\index{get\_full\_path() (raypyng.rml.ObjectElement method)@\spxentry{get\_full\_path()}\spxextra{raypyng.rml.ObjectElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ObjectElement.get_full_path}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_full\_path}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Returns the full path of the xml object
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
path of the xml object

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{resolvable\_name() (raypyng.rml.ObjectElement method)@\spxentry{resolvable\_name()}\spxextra{raypyng.rml.ObjectElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ObjectElement.resolvable_name}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{resolvable\_name}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Returns the name of the objects, removing lab.beamline.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
name of the object

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}



\subsection{ParamElement}
\label{\detokenize{API:paramelement}}\index{ParamElement (class in raypyng.rml)@\spxentry{ParamElement}\spxextra{class in raypyng.rml}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ParamElement}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{class\DUrole{w}{  }}}\sphinxcode{\sphinxupquote{raypyng.rml.}}\sphinxbfcode{\sphinxupquote{ParamElement}}}{\emph{\DUrole{n}{name}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{str}}, \emph{\DUrole{n}{attributes}\DUrole{p}{:}\DUrole{w}{  }\DUrole{n}{dict}}, \emph{\DUrole{o}{**}\DUrole{n}{kwargs}}}{}
\pysigstopsignatures\index{add\_cdata() (raypyng.rml.ParamElement method)@\spxentry{add\_cdata()}\spxextra{raypyng.rml.ParamElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ParamElement.add_cdata}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{add\_cdata}}}{\emph{\DUrole{n}{cdata}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Store cdata

\end{fulllineitems}

\index{add\_child() (raypyng.rml.ParamElement method)@\spxentry{add\_child()}\spxextra{raypyng.rml.ParamElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ParamElement.add_child}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{add\_child}}}{\emph{\DUrole{n}{element}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Store child elements.

\end{fulllineitems}

\index{get\_attribute() (raypyng.rml.ParamElement method)@\spxentry{get\_attribute()}\spxextra{raypyng.rml.ParamElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ParamElement.get_attribute}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_attribute}}}{\emph{\DUrole{n}{key}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Get attributes by key

\end{fulllineitems}

\index{get\_elements() (raypyng.rml.ParamElement method)@\spxentry{get\_elements()}\spxextra{raypyng.rml.ParamElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ParamElement.get_elements}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_elements}}}{\emph{\DUrole{n}{name}\DUrole{o}{=}\DUrole{default_value}{None}}}{}
\pysigstopsignatures
\sphinxAtStartPar
Find a child element by name

\end{fulllineitems}

\index{get\_full\_path() (raypyng.rml.ParamElement method)@\spxentry{get\_full\_path()}\spxextra{raypyng.rml.ParamElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ParamElement.get_full_path}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{get\_full\_path}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Returns the full path of the xml object
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
path of the xml object

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}

\index{resolvable\_name() (raypyng.rml.ParamElement method)@\spxentry{resolvable\_name()}\spxextra{raypyng.rml.ParamElement method}}

\begin{fulllineitems}
\phantomsection\label{\detokenize{API:raypyng.rml.ParamElement.resolvable_name}}
\pysigstartsignatures
\pysiglinewithargsret{\sphinxbfcode{\sphinxupquote{resolvable\_name}}}{}{}
\pysigstopsignatures
\sphinxAtStartPar
Returns the name of the objects, removing lab.beamline.
\begin{quote}\begin{description}
\sphinxlineitem{Returns}
\sphinxAtStartPar
name of the object

\sphinxlineitem{Return type}
\sphinxAtStartPar
str

\end{description}\end{quote}

\end{fulllineitems}


\end{fulllineitems}




\renewcommand{\indexname}{Index}
\printindex
\end{document}